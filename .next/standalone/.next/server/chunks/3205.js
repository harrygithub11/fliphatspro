"use strict";exports.id=3205,exports.ids=[3205],exports.modules={3205:(e,t,n)=>{n.d(t,{ed:()=>a,getSession:()=>c});var s=n(79616),i=n(31865),r=n(7439);let o=new TextEncoder().encode(process.env.JWT_SECRET||"your-secret-key-change-in-production");async function a(e){let t=await new s.N({admin:e}).setProtectedHeader({alg:"HS256"}).setExpirationTime("24h").sign(o);return(0,r.cookies)().set("admin_session",t,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:86400,path:"/"}),t}async function c(){let e=r.cookies().get("admin_session")?.value;if(!e)return null;try{let{payload:t}=await (0,i._)(e,o);return t.admin}catch(e){return null}}}};