(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2582],{40196:function(e,t,s){Promise.resolve().then(s.bind(s,25684))},25684:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Z}});var a=s(3827),r=s(64090),n=s(27815),l=s(85754),i=s(31478),d=s(40110),c=s(47934),o=s(45509),u=s(42706),x=s(49842),m=s(90684),f=s(85904),h=s(97307),p=s(42065),g=s(30438),j=s(69475),v=s(51318),N=s(57976),y=s(70094),b=s(26490),w=s(80223),k=s(79990),_=s(37451),C=s(45179),S=s(23444);let z=(e,t)=>{try{let t=JSON.parse(e);if("booking_form"===t.source&&"form_submitted"===t.action)return"\uD83D\uDCDE Requested a strategy call".concat(t.store?" for ".concat(t.store):"");if(t.action)return t.action.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase());return e}catch(t){return e}};function Z(e){let{params:t}=e,[s,Z]=(0,r.useState)("timeline"),[D,O]=(0,r.useState)(""),[P,T]=(0,r.useState)(!1),[R,Q]=(0,r.useState)(!0),[V,A]=(0,r.useState)(null),[L,U]=(0,r.useState)(!1),[I,J]=(0,r.useState)(!1),[Y,B]=(0,r.useState)(""),[F,W]=(0,r.useState)(""),[E,$]=(0,r.useState)(""),[q,G]=(0,r.useState)("medium"),[H,K]=(0,r.useState)(""),[M,X]=(0,r.useState)("initiated"),[ee,et]=(0,r.useState)(!1),[es,ea]=(0,r.useState)(""),[er,en]=(0,r.useState)(""),[el,ei]=(0,r.useState)(!1),[ed,ec]=(0,r.useState)(""),[eo,eu]=(0,r.useState)(""),[ex,em]=(0,r.useState)("");if((0,r.useEffect)(()=>{(async function(){try{let e=await fetch("/api/admin/leads/".concat(t.id)),s=await e.json();s.success&&A(s.data)}catch(e){console.error("Failed to load profile",e)}finally{Q(!1)}})()},[t.id]),R)return(0,a.jsx)("div",{className:"p-10 text-center",children:"Loading 360 View..."});if(!V)return(0,a.jsx)("div",{className:"p-10 text-center text-red-500",children:"Lead not found."});let{profile:ef,deals:eh,tasks:ep,timeline:eg,files:ej}=V,ev=async()=>{try{let e=await fetch("/api/admin/leads/".concat(t.id)),s=await e.json();s.success&&A(s.data)}catch(e){console.error(e)}},eN=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"internal_note",t=arguments.length>1?arguments[1]:void 0,s=t||D;if(s.trim()){T(!0);try{(await fetch("/api/admin/interactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:ef.id,type:e,content:s})})).ok&&(O(""),await ev())}catch(e){console.error(e)}finally{T(!1)}}},ey=e=>{"call"===e&&(eN("call_log","Outgoing call initiated to ".concat(ef.phone)),window.location.href="tel:".concat(ef.phone)),"whatsapp"===e&&(eN("whatsapp_msg","Opened WhatsApp chat with ".concat(ef.name)),window.open("https://wa.me/".concat(ef.phone.replace(/[^0-9]/g,"")),"_blank")),"proposal"===e&&eN("system_event","Started creating a new proposal.")},eb=async(e,s)=>{let a={...V};A({...V,profile:{...V.profile,[e]:s}});try{if(!(await fetch("/api/admin/leads/".concat(t.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[e]:s})})).ok)throw Error("Update failed");eN("system_event","Updated ".concat(e," to ").concat(s))}catch(e){console.error(e),A(a)}},ew=async()=>{if(!Y)return;let e=F;F&&E?e="".concat(F," ").concat(E,":00"):F&&(e="".concat(F," 00:00:00"));try{await fetch("/api/admin/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:Y,due_date:e,priority:q,customer_id:ef.id})}),U(!1),B(""),W(""),$(""),ev()}catch(e){console.error(e)}},ek=async()=>{if(H)try{await fetch("/api/admin/deals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:H,status:M,customer_id:ef.id})}),J(!1),K(""),ev()}catch(e){console.error(e)}},e_=async(e,t)=>{let s="done"===t?"open":"done",a={...V},r=ep.map(t=>t.id===e?{...t,status:s}:t);A({...V,tasks:r});try{await fetch("/api/admin/tasks",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,status:s})})}catch(e){A(a)}},eC=async(e,t,s)=>{let a={...V},r=ep.map(a=>a.id===e?{...a,[t]:s}:a);A({...V,tasks:r});try{await fetch("/api/admin/tasks",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,[t]:s})})}catch(e){A(a)}},eS=async(e,t,s)=>{let a={...V},r=eh.map(a=>a.id===e?{...a,[t]:s}:a);A({...V,deals:r});try{await fetch("/api/admin/deals",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,[t]:s})}),eN("system_event","Updated Deal #".concat(e," ").concat(t," to ").concat(s))}catch(e){A(a)}},ez=async()=>{if(es&&er)try{await fetch("/api/admin/files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:ef.id,file_name:es,file_url:er,file_type:"link"})}),et(!1),ea(""),en(""),ev()}catch(e){console.error(e)}},eZ=async()=>{if(!ed||!eo){alert("Please fill in all fields");return}try{let e=await fetch("/api/admin/proposals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:ef.id,title:ed,amount:eo,content:ex})}),t=await e.json();if(!t.success){alert("Failed: "+t.message);return}ei(!1),ec(""),eu(""),em(""),ev(),alert("Proposal Created Successfully!")}catch(e){console.error(e),alert("Error creating proposal")}},eD=()=>{try{if("string"==typeof ef.tags)return JSON.parse(ef.tags);if(Array.isArray(ef.tags))return ef.tags;return[]}catch(e){return[]}},eO=e=>e?e.startsWith("http://")||e.startsWith("https://")?e:"https://".concat(e):"#";return(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-6 h-[calc(100vh-8rem)]",children:[(0,a.jsxs)("div",{className:"col-span-3 flex flex-col gap-6 overflow-y-auto pr-2",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"pb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsx)("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center text-2xl font-bold text-primary mb-4",children:ef.name.charAt(0)}),(0,a.jsxs)(o.Ph,{value:ef.score,onValueChange:e=>eb("score",e),children:[(0,a.jsx)(o.i4,{className:"w-[100px] h-8 text-xs uppercase tracking-wide border border-red-200 bg-red-50 text-red-700 hover:bg-red-100 p-2 rounded-md",children:(0,a.jsx)(o.ki,{placeholder:"Score"})}),(0,a.jsxs)(o.Bw,{children:[(0,a.jsx)(o.Ql,{value:"hot",children:"HOT \uD83D\uDD25"}),(0,a.jsx)(o.Ql,{value:"warm",children:"WARM \uD83C\uDF24️"}),(0,a.jsx)(o.Ql,{value:"cold",children:"COLD ❄️"})]})]})]}),(0,a.jsx)(n.ll,{className:"text-xl",children:ef.name}),(0,a.jsx)(n.SZ,{className:"flex items-center gap-2 mt-2",children:(0,a.jsxs)(o.Ph,{value:ef.stage,onValueChange:e=>eb("stage",e),children:[(0,a.jsx)(o.i4,{className:"h-8 border text-sm p-2 bg-background hover:bg-muted/50 w-[160px] rounded-md",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"w-2 h-2 rounded-full inline-block ".concat("won"===ef.stage?"bg-green-500":"bg-yellow-500")}),(0,a.jsx)(o.ki,{placeholder:"Stage"})]})}),(0,a.jsxs)(o.Bw,{children:[(0,a.jsx)(o.Ql,{value:"new",children:"New Lead"}),(0,a.jsx)(o.Ql,{value:"contacted",children:"Contacted"}),(0,a.jsx)(o.Ql,{value:"proposal_sent",children:"Proposal Sent"}),(0,a.jsx)(o.Ql,{value:"negotiation",children:"Negotiation"}),(0,a.jsx)(o.Ql,{value:"won",children:"Won Deal \uD83D\uDCB0"}),(0,a.jsx)(o.Ql,{value:"lost",children:"Lost"})]})]})})]}),(0,a.jsxs)(n.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-muted-foreground",children:[(0,a.jsx)(m.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-foreground truncate",children:ef.email})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-muted-foreground",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-foreground",children:ef.phone})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 text-muted-foreground",children:[(0,a.jsx)(h.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Added ",new Date(ef.created_at).toLocaleDateString()]})]})]}),(0,a.jsx)(c.Separator,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-muted-foreground mb-2",children:"TAGS"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:eD().length>0?eD().map(e=>(0,a.jsxs)(i.C,{variant:"secondary",className:"text-xs font-normal",children:["#",e]},e)):(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"No tags"})})]}),(0,a.jsx)(c.Separator,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-muted-foreground mb-2",children:"OWNER"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full bg-zinc-200 flex items-center justify-center text-xs",children:"A"}),ef.owner||"Unassigned"]})]})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"py-4",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Quick Actions"})}),(0,a.jsxs)(n.aY,{className:"grid gap-2",children:[(0,a.jsxs)(l.z,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>ey("call"),children:[(0,a.jsx)(p.Z,{className:"w-4 h-4"})," Log Call"]}),(0,a.jsxs)(l.z,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>ey("whatsapp"),children:[(0,a.jsx)(g.Z,{className:"w-4 h-4"})," WhatsApp"]}),(0,a.jsxs)(u.Vq,{open:el,onOpenChange:ei,children:[(0,a.jsx)(u.hg,{asChild:!0,children:(0,a.jsxs)(l.z,{variant:"outline",className:"w-full justify-start gap-2",children:[(0,a.jsx)(j.Z,{className:"w-4 h-4"})," Create Proposal"]})}),(0,a.jsxs)(u.cZ,{children:[(0,a.jsx)(u.fK,{children:(0,a.jsx)(u.$N,{children:"Create New Proposal"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Project / Proposal Title"}),(0,a.jsx)(C.I,{placeholder:"e.g. Website Redesign...",value:ed,onChange:e=>ec(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Estimated Amount (₹)"}),(0,a.jsx)(C.I,{type:"number",placeholder:"50000",value:eo,onChange:e=>eu(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Scope / Description"}),(0,a.jsx)(S.g,{placeholder:"Outline the deliverables...",value:ex,onChange:e=>em(e.target.value)})]}),(0,a.jsx)(l.z,{onClick:eZ,className:"w-full",children:"Generate Proposal Draft"})]})]})]})]})]})]}),(0,a.jsxs)("div",{className:"col-span-5 flex flex-col gap-6 overflow-y-auto pr-2",children:[eh.length>0&&(0,a.jsxs)(n.Zb,{className:"bg-slate-900 text-white border-none shadow-xl relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-0 right-0 p-3 opacity-10",children:(0,a.jsx)(v.Z,{className:"w-24 h-24"})}),(0,a.jsxs)(n.Ol,{className:"pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium text-slate-300",children:"Active Project Tracker"}),(0,a.jsxs)(n.SZ,{className:"text-slate-400 text-xs",children:["Showing status for latest deal: ",(0,a.jsxs)("span",{className:"text-white font-bold",children:["#",eh[0].id]})]})]}),(0,a.jsx)(n.aY,{className:"pb-6",children:(0,a.jsx)("div",{className:"flex items-center justify-between relative mt-2",children:["initiated","paid","processing","delivered"].map((e,t,s)=>{let r=eh[0].status,n=s.indexOf(e),l=s.indexOf(r),i=n<=l,d=n===l;return(0,a.jsxs)("div",{onClick:()=>eS(eh[0].id,"status",e),className:"flex flex-col items-center relative z-10 w-full cursor-pointer group",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-all duration-300 ".concat(i?"bg-green-500 text-white shadow-lg shadow-green-900/20":"bg-slate-700 text-slate-400 group-hover:bg-slate-600"," ").concat(d?"ring-2 ring-white scale-110":""),children:i&&!d?(0,a.jsx)(N.Z,{className:"w-4 h-4"}):t+1}),(0,a.jsx)("span",{className:"text-[10px] mt-2 font-medium uppercase tracking-wide transition-colors ".concat(i?"text-green-400":"text-slate-500 group-hover:text-slate-400"),children:e.replace("_"," ")}),t!==s.length-1&&(0,a.jsx)("div",{className:"absolute top-4 left-1/2 w-full h-[2px] -z-10 transition-colors duration-500 ".concat(n<l?"bg-green-500":"bg-slate-800")})]},e)})})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"py-4 flex flex-row items-center justify-between",children:[(0,a.jsx)(n.ll,{className:"text-base",children:"Deals & Proposals"}),(0,a.jsxs)(u.Vq,{open:I,onOpenChange:J,children:[(0,a.jsx)(u.hg,{asChild:!0,children:(0,a.jsx)(l.z,{size:"sm",variant:"ghost",children:(0,a.jsx)(y.Z,{className:"w-4 h-4"})})}),(0,a.jsxs)(u.cZ,{children:[(0,a.jsx)(u.fK,{children:(0,a.jsx)(u.$N,{children:"Create New Deal"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Amount (₹)"}),(0,a.jsx)(C.I,{type:"number",value:H,onChange:e=>K(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Initial Status"}),(0,a.jsxs)(o.Ph,{value:M,onValueChange:X,children:[(0,a.jsx)(o.i4,{children:(0,a.jsx)(o.ki,{})}),(0,a.jsxs)(o.Bw,{children:[(0,a.jsx)(o.Ql,{value:"getting_ready",children:"Draft/Proposal"}),(0,a.jsx)(o.Ql,{value:"initiated",children:"Initiated"}),(0,a.jsx)(o.Ql,{value:"paid",children:"Paid"})]})]})]}),(0,a.jsx)(l.z,{onClick:ek,children:"Create Deal"})]})]})]})]}),(0,a.jsxs)(n.aY,{className:"space-y-3",children:[0===eh.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No active deals."}),eh.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-zinc-50 dark:bg-zinc-900/50",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-semibold text-sm",children:["Deal #",e.id]}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-bold text-sm",children:["₹",e.amount]}),(0,a.jsxs)(o.Ph,{value:e.status,onValueChange:t=>eS(e.id,"status",t),children:[(0,a.jsx)(o.i4,{className:"h-6 w-[90px] text-[10px] border-none p-0 justify-end shadow-none hover:bg-transparent",children:(0,a.jsx)(i.C,{variant:"paid"===e.status||"won"===e.status?"default":"secondary",className:"h-5 px-2 hover:bg-primary/90 pointer-events-none",children:e.status})}),(0,a.jsxs)(o.Bw,{children:[(0,a.jsx)(o.Ql,{value:"draft",children:"Draft"}),(0,a.jsx)(o.Ql,{value:"getting_ready",children:"Reviewing"}),(0,a.jsx)(o.Ql,{value:"initiated",children:"Initiated"}),(0,a.jsx)(o.Ql,{value:"paid",children:"Paid ✅"}),(0,a.jsx)(o.Ql,{value:"cancelled",children:"Cancelled ❌"})]})]})]})]},e.id))]})]}),(0,a.jsxs)(n.Zb,{className:"flex-1",children:[(0,a.jsxs)(n.Ol,{className:"py-4 flex flex-row items-center justify-between",children:[(0,a.jsx)(n.ll,{className:"text-base",children:"Tasks & Follow-ups"}),(0,a.jsxs)(u.Vq,{open:L,onOpenChange:U,children:[(0,a.jsx)(u.hg,{asChild:!0,children:(0,a.jsx)(l.z,{size:"sm",variant:"ghost",children:(0,a.jsx)(y.Z,{className:"w-4 h-4"})})}),(0,a.jsxs)(u.cZ,{children:[(0,a.jsx)(u.fK,{children:(0,a.jsx)(u.$N,{children:"Add New Task"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Task Title"}),(0,a.jsx)(C.I,{placeholder:"Follow up call...",value:Y,onChange:e=>B(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Due Date"}),(0,a.jsx)(C.I,{type:"date",value:F,onChange:e=>W(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Time"}),(0,a.jsx)(C.I,{type:"time",value:E,onChange:e=>$(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"Priority"}),(0,a.jsxs)(o.Ph,{value:q,onValueChange:G,children:[(0,a.jsx)(o.i4,{children:(0,a.jsx)(o.ki,{})}),(0,a.jsxs)(o.Bw,{children:[(0,a.jsx)(o.Ql,{value:"high",children:"High"}),(0,a.jsx)(o.Ql,{value:"medium",children:"Medium"}),(0,a.jsx)(o.Ql,{value:"low",children:"Low"})]})]})]}),(0,a.jsx)(l.z,{onClick:ew,children:"Save Task"})]})]})]})]}),(0,a.jsxs)(n.aY,{className:"space-y-0",children:[0===ep.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No pending tasks."}),ep.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start gap-3 p-3 ".concat(t!==ep.length-1?"border-b":""),children:[(0,a.jsx)("button",{onClick:()=>e_(e.id,e.status),className:"mt-0.5 w-4 h-4 rounded border flex items-center justify-center transition-colors ".concat("done"===e.status?"bg-green-500 border-green-500 text-white":"border-zinc-300 hover:border-zinc-400"),children:"done"===e.status&&(0,a.jsx)(N.Z,{className:"w-3 h-3"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium ".concat("done"===e.status&&"line-through text-muted-foreground"),children:e.title}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsxs)(o.Ph,{value:e.priority,onValueChange:t=>eC(e.id,"priority",t),children:[(0,a.jsx)(o.i4,{className:"h-4 p-0 border-none shadow-none w-auto",children:(0,a.jsx)(i.C,{variant:"outline",className:"text-[10px] px-1 py-0 h-4 hover:bg-muted cursor-pointer ".concat("high"===e.priority?"text-red-500 border-red-200 bg-red-50":""),children:e.priority||"Normal"})}),(0,a.jsxs)(o.Bw,{children:[(0,a.jsx)(o.Ql,{value:"high",children:"High"}),(0,a.jsx)(o.Ql,{value:"medium",children:"Medium"}),(0,a.jsx)(o.Ql,{value:"low",children:"Low"})]})]}),e.due_date&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-[10px] ".concat("done"!==e.status&&"text-red-500 font-medium"),children:[(0,a.jsx)(b.Z,{className:"w-3 h-3"}),new Date(e.due_date).toLocaleString([],{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})]},e.id))]})]})]}),(0,a.jsx)("div",{className:"col-span-4 flex flex-col h-full overflow-hidden",children:(0,a.jsx)(n.Zb,{className:"h-full flex flex-col shadow-none border-l-0 rounded-l-none bg-transparent",children:(0,a.jsxs)(d.mQ,{defaultValue:"timeline",className:"flex-1 flex flex-col h-full",children:[(0,a.jsx)("div",{className:"px-4 pt-4 shrink-0",children:(0,a.jsxs)(d.dr,{className:"w-full grid grid-cols-2",children:[(0,a.jsx)(d.SP,{value:"timeline",children:"Timeline"}),(0,a.jsx)(d.SP,{value:"files",children:"Files"})]})}),(0,a.jsxs)(d.nU,{value:"timeline",className:"flex-1 flex flex-col overflow-hidden mt-0",children:[(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[0===eg.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No history yet."}),eg.map((e,t)=>(0,a.jsxs)("div",{className:"flex gap-4 relative",children:[t!==eg.length-1&&(0,a.jsx)("div",{className:"absolute left-4 top-8 bottom-[-24px] w-px bg-zinc-200 dark:bg-zinc-800"}),e.created_by_name?(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center shrink-0 z-10 text-white text-xs font-bold\n                                                ".concat("Admin User"===e.created_by_name?"bg-blue-500":"John Doe"===e.created_by_name?"bg-green-500":"Sarah Smith"===e.created_by_name?"bg-purple-500":"bg-gray-500"),children:e.created_by_name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)}):(0,a.jsxs)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center shrink-0 z-10 \n                                                ".concat("call_log"===e.type?"bg-blue-100 text-blue-600":"whatsapp_msg"===e.type?"bg-green-100 text-green-600":"system_event"===e.type?"bg-zinc-100 text-zinc-600":"bg-purple-100 text-purple-600"),children:["call_log"===e.type&&(0,a.jsx)(p.Z,{className:"w-4 h-4"}),"whatsapp_msg"===e.type&&(0,a.jsx)(g.Z,{className:"w-4 h-4"}),"system_event"===e.type&&(0,a.jsx)(j.Z,{className:"w-4 h-4"})]}),(0,a.jsxs)("div",{className:"flex-1 pb-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs font-semibold",children:e.created_by_name||"System"}),(0,a.jsx)("span",{className:"text-[10px] text-muted-foreground",children:new Date(e.created_at).toLocaleTimeString()})]}),(0,a.jsx)("div",{className:"text-xs bg-white dark:bg-zinc-900 border p-3 rounded-lg mt-1 shadow-sm",children:z(e.content,e.type)})]})]},e.id))]}),(0,a.jsxs)("div",{className:"p-4 bg-zinc-50 dark:bg-zinc-900 border-t shrink-0",children:[(0,a.jsx)(S.g,{placeholder:"Type a note, or log a call...",className:"min-h-[80px] mb-2 bg-white dark:bg-black",value:D,onChange:e=>O(e.target.value)}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)(l.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(w.Z,{className:"w-4 h-4"})})}),(0,a.jsxs)(l.z,{size:"sm",className:"gap-2",onClick:()=>eN(),disabled:P,children:[(0,a.jsx)(k.Z,{className:"w-3 h-3"})," ",P?"Saving...":"Log Activity"]})]})]})]}),(0,a.jsxs)(d.nU,{value:"files",className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold",children:"Attachments & Links"}),(0,a.jsxs)(u.Vq,{open:ee,onOpenChange:et,children:[(0,a.jsx)(u.hg,{asChild:!0,children:(0,a.jsxs)(l.z,{size:"sm",variant:"outline",children:[(0,a.jsx)(y.Z,{className:"w-4 h-4 mr-2"})," Add Link"]})}),(0,a.jsxs)(u.cZ,{children:[(0,a.jsx)(u.fK,{children:(0,a.jsx)(u.$N,{children:"Add File or Link"})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"File Name"}),(0,a.jsx)(C.I,{placeholder:"Proposal V1...",value:es,onChange:e=>ea(e.target.value)})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(x._,{children:"URL / Link"}),(0,a.jsx)(C.I,{placeholder:"https://docs.google.com/...",value:er,onChange:e=>en(e.target.value)})]}),(0,a.jsx)(l.z,{onClick:ez,children:"Save Attachment"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[0===(ej||[]).length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center py-10",children:"No files uploaded yet."}),(ej||[]).map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-zinc-50 dark:hover:bg-zinc-900 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-10 w-10 bg-primary/10 rounded flex items-center justify-center text-primary",children:(0,a.jsx)(w.Z,{className:"w-5 h-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("a",{href:eO(e.file_url),target:"_blank",rel:"noreferrer",className:"text-sm font-medium hover:underline block",children:e.file_name}),(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})]})]}),(0,a.jsx)("a",{href:eO(e.file_url),target:"_blank",rel:"noreferrer",children:(0,a.jsx)(l.z,{size:"icon",variant:"ghost",className:"h-8 w-8 text-muted-foreground",children:(0,a.jsx)(_.Z,{className:"w-4 h-4"})})})]},e.id))]})]})]})})})]})}},31478:function(e,t,s){"use strict";s.d(t,{C:function(){return i}});var a=s(3827);s(64090);var r=s(49769),n=s(1657);let l=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:s}),t),...r})}},85754:function(e,t,s){"use strict";s.d(t,{z:function(){return c}});var a=s(3827),r=s(64090),n=s(59143),l=s(49769),i=s(1657);let d=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:c=!1,...o}=e,u=c?n.g7:"button";return(0,a.jsx)(u,{className:(0,i.cn)(d({variant:r,size:l,className:s})),ref:t,...o})});c.displayName="Button"},27815:function(e,t,s){"use strict";s.d(t,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return d}});var a=s(3827),r=s(64090),n=s(1657);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});l.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",s),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",s),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},42706:function(e,t,s){"use strict";s.d(t,{$N:function(){return p},Be:function(){return g},GG:function(){return u},Vq:function(){return d},cN:function(){return h},cZ:function(){return m},fK:function(){return f},hg:function(){return c}});var a=s(3827),r=s(64090),n=s(43996),l=s(52235),i=s(1657);let d=n.fC,c=n.xz,o=n.h_,u=n.x8,x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});x.displayName=n.aV.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...d}=e;return(0,a.jsxs)(o,{children:[(0,a.jsx)(x,{}),(0,a.jsxs)(n.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...d,children:[r,(0,a.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.VY.displayName;let f=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};f.displayName="DialogHeader";let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};h.displayName="DialogFooter";let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});p.displayName=n.Dx.displayName;let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});g.displayName=n.dk.displayName},45179:function(e,t,s){"use strict";s.d(t,{I:function(){return l}});var a=s(3827),r=s(64090),n=s(1657);let l=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...l})});l.displayName="Input"},49842:function(e,t,s){"use strict";s.d(t,{_:function(){return c}});var a=s(3827),r=s(64090),n=s(76028),l=s(49769),i=s(1657);let d=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,i.cn)(d(),s),...r})});c.displayName=n.f.displayName},45509:function(e,t,s){"use strict";s.d(t,{Bw:function(){return h},Ph:function(){return o},Ql:function(){return p},i4:function(){return x},ki:function(){return u}});var a=s(3827),r=s(64090),n=s(91518),l=s(23441),i=s(85159),d=s(80037),c=s(1657);let o=n.fC;n.ZA;let u=n.B4,x=r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(n.xz,{ref:t,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[r,(0,a.jsx)(n.JO,{asChild:!0,children:(0,a.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=n.xz.displayName;let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});m.displayName=n.u_.displayName;let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})});f.displayName=n.$G.displayName;let h=r.forwardRef((e,t)=>{let{className:s,children:r,position:l="popper",...i}=e;return(0,a.jsx)(n.h_,{children:(0,a.jsxs)(n.VY,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,a.jsx)(m,{}),(0,a.jsx)(n.l_,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(f,{})]})})});h.displayName=n.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=n.__.displayName;let p=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(n.ck,{ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(n.eT,{children:r})]})});p.displayName=n.ck.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=n.Z0.displayName},47934:function(e,t,s){"use strict";s.r(t),s.d(t,{Separator:function(){return i}});var a=s(3827),r=s(64090),n=s(57361),l=s(1657);let i=r.forwardRef((e,t)=>{let{className:s,orientation:r="horizontal",decorative:i=!0,...d}=e;return(0,a.jsx)(n.f,{ref:t,decorative:i,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...d})});i.displayName=n.f.displayName},40110:function(e,t,s){"use strict";s.d(t,{SP:function(){return c},dr:function(){return d},mQ:function(){return i},nU:function(){return o}});var a=s(3827),r=s(64090),n=s(64694),l=s(1657);let i=n.fC,d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.aV,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});d.displayName=n.aV.displayName;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.xz,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});c.displayName=n.xz.displayName;let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});o.displayName=n.VY.displayName},23444:function(e,t,s){"use strict";s.d(t,{g:function(){return l}});var a=s(3827),r=s(64090),n=s(1657);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...r})});l.displayName="Textarea"},1657:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(75504),r=s(51367);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[2150,567,451,3765,5101,2688,6341,5997,2971,8069,1744],function(){return e(e.s=40196)}),_N_E=e.O()}]);